The R package batteryreduction is an R equivalent of SAS macro at http://www.lexjansen.com/nesug/nesug92/NESUG92090.pdf. 
